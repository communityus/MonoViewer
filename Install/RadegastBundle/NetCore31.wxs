<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">

  <!--
  "%WIX%\bin\heat.exe" payload "dotnet-runtime-3.1.16-win-x64.exe" -o "dotnet-runtime.wxs"
  "%WIX%\bin\heat.exe" payload "aspnetcore-runtime-3.1.16-win-x64.exe" -o "aspnetcore-runtime.wxs"
  "%WIX%\bin\heat.exe" payload "windowsdesktop-runtime-3.1.16-win-x64.exe" -o "windowsdesktop-runtime.wxs"
  -->

	<?define DotNetRuntime31WebLink = "https://download.visualstudio.microsoft.com/download/pr/c5ac98b1-ca0c-4fb9-8081-b57b7d1aff15/3bf549e382b0b5f18a5ab7e6017bd096/dotnet-runtime-3.1.16-win-x64.exe" ?>
	<?define AspNetCoreRuntime31WebLink = "https://download.visualstudio.microsoft.com/download/pr/a59188f0-7ac7-4cb7-b808-ac9a69c2fd68/8f14e0256f4986c13e053235ee44c297/aspnetcore-runtime-3.1.16-win-x64.exe" ?>
	<?define WindowsDesktopRuntime31WebLink = "https://download.visualstudio.microsoft.com/download/pr/7cea63ad-1e76-41f0-a54a-eacb48fec749/87c339835cd7647c0fee3f14820cd909/windowsdesktop-runtime-3.1.16-win-x64.exe" ?>
		
	<Fragment>
		<Variable Name="DotNetRuntime31InstallDir" Value="[ProgramFiles64Folder]dotnet\shared\Microsoft.NETCore.App\3.1.16"/>
		<util:DirectorySearch Id="DotNetRuntime31Installed" Path="[DotNetRuntime31InstallDir]" Variable="DotNetRuntime31Installed" Result="exists"/>

		<WixVariable Id="DotNetRuntime31WebDetectCondition" Value="DotNetRuntime31Installed" Overridable="yes"/>
		<WixVariable Id="DotNetRuntime31WebInstallCondition" Value="" Overridable="yes"/>

		<PackageGroup Id="DotNetRuntime31Web">
			<ExePackage
			  Name="dotnet-runtime-3.1.16-win-x64.exe"
			  InstallCommand="/install /quiet /norestart /log &quot;[DotNetRuntime31Log]&quot;"
			  RepairCommand="/repair /quiet /norestart /log &quot;[DotNetRuntime31Log]&quot;"
			  UninstallCommand="/uninstall /quiet /norestart /log &quot;[DotNetRuntime31Log]&quot;"
			  PerMachine="yes"
			  DetectCondition="!(wix.DotNetRuntime31WebDetectCondition)"
			  InstallCondition="!(wix.DotNetRuntime31WebInstallCondition)"
			  Vital="yes"
			  Permanent="yes"
			  Protocol="burn"
			  DownloadUrl="$(var.DotNetRuntime31WebLink)"
			  LogPathVariable="DotNetRuntime31Log"
			  Compressed="no">
				<RemotePayload CertificatePublicKey="F49F9B33E25E33CCA0BFB15A62B7C29FFAB3880B" CertificateThumbprint="ABDCA79AF9DD48A0EA702AD45260B3C03093FB4B" Description="Microsoft .NET Core Runtime - 3.1.16 (x64)" 
							   Hash="D391DA8864C6B42BB89229B0C3240BB94B2DE61E" ProductName="Microsoft .NET Core Runtime - 3.1.16 (x64)" Size="26249152" Version="3.1.16.30112" />

			</ExePackage>
		</PackageGroup>
	</Fragment>

	<Fragment>
		<Variable Name="AspNetCoreRuntime31InstallDir" Value="[ProgramFiles64Folder]dotnet\shared\Microsoft.AspNetCore.App\3.1.16"/>
		<util:DirectorySearch Id="AspNetCoreRuntime31Installed" Path="[AspNetCoreRuntime31InstallDir]" Variable="AspNetCoreRuntime31Installed" Result="exists"/>

		<WixVariable Id="AspNetCoreRuntime31WebDetectCondition" Value="AspNetCoreRuntime31Installed" Overridable="yes"/>
		<WixVariable Id="AspNetCoreRuntime31WebInstallCondition" Value="" Overridable="yes"/>

		<PackageGroup Id="AspNetCoreRuntime31Web">
			<ExePackage
			  Name="aspnetcore-runtime-3.1.16-win-x64.exe"
			  InstallCommand="/install /quiet /norestart /log &quot;[AspNetCoreRuntime31Log]&quot;"
			  RepairCommand="/repair /quiet /norestart /log &quot;[AspNetCoreRuntime31Log]&quot;"
			  UninstallCommand="/uninstall /quiet /norestart /log &quot;[AspNetCoreRuntime31Log]&quot;"
			  PerMachine="yes"
			  DetectCondition="!(wix.AspNetCoreRuntime31WebDetectCondition)"
			  InstallCondition="!(wix.AspNetCoreRuntime31WebInstallCondition)"
			  Vital="yes"
			  Permanent="yes"
			  Protocol="burn"
			  DownloadUrl="$(var.AspNetCoreRuntime31WebLink)"
			  LogPathVariable="AspNetCoreRuntime31Log"
			  Compressed="no">
				<RemotePayload CertificatePublicKey="F49F9B33E25E33CCA0BFB15A62B7C29FFAB3880B" CertificateThumbprint="ABDCA79AF9DD48A0EA702AD45260B3C03093FB4B" Description="Microsoft ASP.NET Core 3.1.16 - Shared Framework" 
							   Hash="6819A8BD0C6795630526B00D02A48A2C57E57B36" ProductName="Microsoft ASP.NET Core 3.1.16 - Shared Framework" Size="7864992" Version="3.1.16.21263" />

			</ExePackage>
		</PackageGroup>
	</Fragment>

	<Fragment>
		<Variable Name="WindowsDesktopRuntime31InstallDir" Value="[ProgramFiles64Folder]dotnet\shared\Microsoft.WindowsDesktop.App\3.1.16"/>
		<util:DirectorySearch Id="WindowsDesktopRuntime31Installed" Path="[WindowsDesktopRuntime31InstallDir]" Variable="WindowsDesktopRuntime31Installed" Result="exists"/>

		<WixVariable Id="WindowsDesktopRuntime31WebDetectCondition" Value="WindowsDesktopRuntime31Installed" Overridable="yes"/>
		<WixVariable Id="WindowsDesktopRuntime31WebInstallCondition" Value="" Overridable="yes"/>

		<PackageGroup Id="WindowsDesktopRuntime31Web">
			<ExePackage
			  Name="windowsdesktop-runtime-3.1.16-win-x64.exe"
			  InstallCommand="/install /quiet /norestart /log &quot;[WindowsDesktopRuntime31Log]&quot;"
			  RepairCommand="/repair /quiet /norestart /log &quot;[WindowsDesktopRuntime31Log]&quot;"
			  UninstallCommand="/uninstall /quiet /norestart /log &quot;[WindowsDesktopRuntime31Log]&quot;"
			  PerMachine="yes"
			  DetectCondition="!(wix.WindowsDesktopRuntime31WebDetectCondition)"
			  InstallCondition="!(wix.WindowsDesktopRuntime31WebInstallCondition)"
			  Vital="yes"
			  Permanent="yes"
			  Protocol="burn"
			  DownloadUrl="$(var.WindowsDesktopRuntime31WebLink)"
			  LogPathVariable="WindowsDesktopRuntime31Log"
			  Compressed="no">
				<RemotePayload CertificatePublicKey="F49F9B33E25E33CCA0BFB15A62B7C29FFAB3880B" CertificateThumbprint="ABDCA79AF9DD48A0EA702AD45260B3C03093FB4B" Description="Microsoft Windows Desktop Runtime - 3.1.16 (x64)" 
							   Hash="FB7B97D3BC49DF40EC956B1D57BF7E6DBEFD35A0" ProductName="Microsoft Windows Desktop Runtime - 3.1.16 (x64)" Size="54394104" Version="3.1.16.30112" />
			</ExePackage>
		</PackageGroup>
	</Fragment>
</Wix>
